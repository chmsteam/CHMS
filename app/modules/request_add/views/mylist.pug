extends ../../../templates/navbarclient.pug
block content
    section#services
        .right_col(role='main' style="background-color:transparent;")
            .page-title
                .row
                    .col-md-12.col-sm-12.col-xs-12
                       
                            
                                .row
                                    each list in listtab
                                        h2(style="font-size:33px;") &nbsp&nbspName of list: 
                                            b   " #{list.strRequestName} "
                                .x_panel
                                    .x_title
                                    .x_title
                                        .clearfix
                                        .x_panel.alert-success(style='background-color:')
                                            h3(style="font-size:18px;")(align='center')
                                                b   &nbsp&nbsp&nbsp&nbsp&nbspDisclaimer !!!
                                                    br
                                                    br
                                                li
                                                    | To add service on your list, just click <b>"add service"</b> button.
                                    br
                                    each list in listtab
                                        if (list.strRequestStatus == 'Draft' || list.strRequestStatus == 'On process')
                                            button.btn.btn-success.btn-lg(type='button' data-toggle="modal" data-target="#Add")
                                                i.fa.fa-plus
                                                | &nbspAdd Service
                                        else if (list.strRequestStatus == 'On deployment' || list.strRequestStatus == 'Pending')

                                        each count in counttab
                                            if (list.strRequestStatus == 'Draft' && count.counter != 0)
                                                a(href='/request_add/submit_request_'+list.intRequestID)
                                                    button.btn.pull-right.btn-success.btn-lg(type='button')
                                                        i.fa.fa-envelope
                                                        |   Submit List
                                            else if list.strRequestStatus == 'On process' || list.strRequestStatus == 'Pending'
                                    br

                                    .x_panel
                                        h2 Requested Service/s:
                                        table.table.jambo_table.table-bordered
                                            thead
                                                tr
                                                    th Number
                                                    th Service
                                                    th Quantity
                                                    th Results
                                                    th Action
                                            tbody
                                            each item in itemtab
                                                each list in listtab  
                                                    tr
                                                        td #{item.intIRequest_No}
                                                        td #{item.strName}
                                                        td #{item.intIQuantity}
                                                        td #{item.forapproval}
                                                        td
                                                            button.btn.btn-info.btn-xs(type='button' data-toggle="modal" data-target="#view_item"
                                                                                    , data-requestno=item.intIRequest_No, data-servicename=item.strName, data-quantity=item.intIQuantity, data-gender=item.strIRequestGender, data-educ=item.strIRequestEduc, data-exp=item.intIRequestExp
                                                                                    , data-sal= item.deciRequestSalary, data-age=item.intIRequestAge1 , data-ages=item.intIRequestAge2) View
                                                                if list.strRequestStatus == 'Draft'
                                                                    button.btn.btn-warning.btn-xs(type='button' data-toggle="modal" data-target="#edit_item") Edit
                                                                    button.btn.btn-danger.btn-xs(type='button' data-toggle="modal" data-target="#remove_item") Delete
                                                                else if list.strRequestStatus == 'On process'
                                                                    a(href='result_'+item.intIRequestID+item.intIRequest_No)
                                                                        button.btn.btn-primary.btn-xs(type='button') View Result
                                                                    button.btn.btn-danger.btn-xs(type='button' data-toggle="modal" data-target="#remove_item") Delete
                                        each list in listtab
                                            if list.strRequestStatus == 'Pending' || list.strRequestStatus == 'Approved' || list.strRequestStatus == 'Rejected' || list.strRequestStatus == 'Finished'
                                                each transdetails in transdetailstab
                                                    h2 Deployment Details:
                                                    table.table.jambo_table.bulk_action
                                                        thead
                                                            tr
                                                                th Date of Deployment
                                                                th Time of Deployment
                                                                th Type of Deployment
                                                                th Invoice
                                                        tbody
                                                            tr
                                                                td #{transdetails.datDateofDeployment}
                                                                td #{transdetails.timTimeofDeployment}
                                                                if transdetails.intTypeofDeployment == '2'
                                                                    td Drop-off
                                                                else if transdetails.intTypeofDeployment == '3'
                                                                    td Pick-up
                                                                td
                                                                    a(href="/request_add/invoice_"+transdetails.intTRequestID)
                                                                        button.btn.btn-primary.btn-xs(type='button') View

                                //- h2 Services:
                                //- table.table.jambo_table.bulk_action
                                //-     thead
                                //-         tr
                                //-             th Number
                                //-             th Service
                                //-             th Quantity
                                //-             th Results                                            
                                //-             th Action
                                //-     tbody
                                //-     each item in itemtab
                                //-         each list in listtab  
                                //-             tr
                                //-                 td #{item.intIRequest_No}
                                //-                 td #{item.strName}
                                //-                 td #{item.intIQuantity}
                                //-                 td #{item.forapproval}
                                //-                 td
                                //-                     button.btn.btn-info.btn-xs(type='button' data-toggle="modal" data-target="#view_item"
                                //-                                             , data-requestno=item.intIRequest_No, data-servicename=item.strName, data-quantity=item.intIQuantity, data-gender=item.strIRequestGender, data-educ=item.strIRequestEduc, data-exp=item.intIRequestExp
                                //-                                             , data-sal= item.deciRequestSalary, data-age=item.intIRequestAge1 , data-ages=item.intIRequestAge2) View
                                //-                         if list.strRequestStatus == 'Draft'
                                //-                             button.btn.btn-warning.btn-xs(type='button' data-toggle="modal" data-target="#edit_item") Edit
                                //-                             button.btn.btn-danger.btn-xs(type='button' data-toggle="modal" data-target="#remove_item") Delete
                                //-                         else if list.strRequestStatus == 'On process'
                                //-                             a(href='result_'+item.intIRequestID+item.intIRequest_No)
                                //-                                 button.btn.btn-primary.btn-xs(type='button') View Result
                                //-                             button.btn.btn-danger.btn-xs(type='button' data-toggle="modal" data-target="#remove_item") Delete
                                //- each list in listtab
                                //-     if list.strRequestStatus == 'Pending' || list.strRequestStatus == 'Approved' || list.strRequestStatus == 'Rejected' || list.strRequestStatus == 'Finished'
                                //-         each transdetails in transdetailstab
                                //-             h2 Deployment Details:
                                //-             table.table.jambo_table.bulk_action
                                //-                 thead
                                //-                     tr
                                //-                         th Date of Deployment
                                //-                         th Time of Deployment
                                //-                         th Type of Deployment
                                //-                         th Invoice
                                //-                 tbody
                                //-                     tr
                                //-                         td #{transdetails.datDateofDeployment}
                                //-                         td #{transdetails.timTimeofDeployment}
                                //-                         if transdetails.intTypeofDeployment == '2'
                                //-                             td Drop-off
                                //-                         else if transdetails.intTypeofDeployment == '3'
                                //-                             td Pick-up
                                //-                         td
                                //-                             a(href="/request_add/invoice_"+transdetails.intTRequestID)
                                //-                                 button.btn.btn-primary.btn-xs(type='button') View


                                //- if request = Pending
                                //- transaction dets
                    .col-md-12.col-sm-12.col-xs-12
                        br
                        .x_panel
                                .x_title
                                    .x_panel(style='background-color:#394D5F')
                                        h2(style="font-weight:bold; font:white") List of service/s you approved:
                                .x_panel
                                    .clearfix
                                        br
                                        each hw in hwtab
                                            .col-md-4.col-sm-4.col-xs-12.profile_details
                                                form(method="POST" action="/request_add/decision_"+hw.intRRequestID+hw.intRRequest_No)
                                                    input.form-control.col-md-7.col-xs-12(type='text', id='_id', required='required', name='hwid', value=''+hw.intRHWID, style="display:none;")
                                                    input.form-control.col-md-7.col-xs-12(type='text', id='_id', required='required', name='transid', value=''+hw.intRRequestID, style="display:none;")                              
                                                    .well.profile_view
                                                        .col-sm-12
                                                            h4.brief
                                                                i #{hw.strName}
                                                            .left.col-xs-7
                                                                h2 #{hw.strFName} #{hw.strLName}
                                                                p
                                                                    | Age:
                                                                    strong  #{hw.age} 
                                                                ul.list-unstyled
                                                                    li
                                                                        | Gender: 
                                                                        b #{hw.strGender}
                                                                    li
                                                                        | Working Experience: 
                                                                        b 
                                                                    li
                                                                        | Education: 
                                                                        b 
                                                            .right.col-xs-5.text-center
                                                                img.img-circle.img-responsive(src='../images/'+hw.strPicture, alt='', style='width:100px; height:100px')
                                                            .col-xs-12.col-sm-8.emphasis
                                                                a(href='hw_profile_'+hw.intRRequestID+hw.intRHWID)
                                                                    button.btn.btn-primary(type='button')
                                                                        i.fa.fa-user  
                                                                        |  View Profile
                                                                    //- button.btn.btn-warning.btn-md(type='submit' name='btn1' value='revert') Revert
                                .form-group.pull-right
                                    .col-md-12.col-sm-9.col-xs-12.pull-right
                                        br
                                        a(href='/request_add')
                                            button.btn.btn-primary.btn-lg(type='button') Back
                                        each noofapprove in noofapprovetab
                                            each list in listtab
                                                if noofapprove.NOOFapprove > 0 && list.strRequestStatus=='On process'
                                                    button.btn.btn-success.btn-lg(type='button' data-toggle="modal" data-target="#deployment") Deployment Details
                                                else 
                                                
        // Small modal
        #myListCancel1.modal.fade.bs-example-modal-sm(tabindex='-1', role='dialog', aria-hidden='true')
            .modal-dialog.modal-sm
                .modal-content
                    .modal-header
                        button.close(type='button', data-dismiss='modal', aria-label='Close')
                            span(aria-hidden='true') ×
                        h4#myModalLabel2.modal-title
                    .modal-body
                        h3
                            center
                                b Warning!!!
                        p
                            center
                                big Are you sure you want to cancel request in this household worker?
                    .modal-footer
                        button.btn.btn-primary(type='button', data-dismiss='modal') No
                        button.btn.btn-primary(type='button') Yes
        // /modals

        // Add Service Modal
        #Add.modal.fade.modal-icon(tabindex='-1', role='dialog', aria-hidden='true')
            .modal-dialog(role='document')
                each list in listtab
                    form(method='POST', action='add_to_mylist_'+list.intRequestID).form-horizontal
                        .modal-content
                            .modal-header(style="background-color:#2A3F54; color:white")
                                button.close(type='button', data-dismiss='modal')
                                    span(aria-hidden='true') ×
                                h3#myModalLabel.modal-title 
                                    p(style="text-align:center; font-weight:bold") Add Service
                            .modal-body
                            
                                .row
                                    .col-md-1
                                        .form-group
                                        |    &nbsp
                                    .col-md-6
                                        .form-group
                                            br
                                            | Service:
                                            select#skil(name='service').form-control
                                                each service in servicetab
                                                    option(value=''+service.intID) #{service.strName}
                                .row
                                    .col-md-1
                                        .form-group
                                        |    &nbsp
                                    .col-md-3
                                        .form-group
                                            | No. of Person Needed
                                            span.required
                                            input.form-control(type='number' name='quantity' min='1', max='10' value='1' required)
                                    br
                                    
                                    .col-md-3
                                        .form-group
                                            | Gender:
                                            span.required
                                            select(name='gender').form-control
                                                option(value='Any') Any
                                                option(value='Male') Male
                                                option(value='Female') Female
                                    .form-group 
                                        | &nbsp&nbsp&nbspAge (From - To):
                                        .row
                                            .col-md-2
                                                .form-group
                                                    input.form-control(type='number' name='age1' min='18', max='100' value='18' required)
                                            .col-md-2
                                                .form-group
                                                    input.form-control(type='number' name='age2' min='18', max='100' value='18' required)  
                                    
                                .row
                                    .col-md-1
                                        .form-group
                                        |    &nbsp
                                    .col-md-4
                                        .form-group
                                            br
                                            | Highest Educational Attainment:
                                            span.required
                                            select.form-control(name='educ')
                                                option(value='Elementary') Elementary
                                                option(value='High School') High School
                                                option(value='College') College
                                                option(value='Vocational') Vocational
                                    .col-md-2
                                        .form-group
                                            | Work Experience (at least):
                                            span.required
                                            input#first-name.form-control.col-md-7.col-xs-12(type='number' name='workexp' value='0')
                                
                                    .col-md-4
                                        br
                                        .form-group
                                            | Willing to work for a monthly salary of (minimum):&nbspP
                                            span.required
                                            input#first-name.form-control.col-md-7.col-xs-12(type='number' name='salary' value='0')
                                br
                                .row
                                    .col-md-2
                                        .form-group
                                        |    &nbsp
                                    .col-md-8
                                        .x_panel(align='center')
                                            .x_title
                                                h5
                                                    b Recommended Salary
                                                .clearfix
                                            .x_content
                                                .row
                                                    .col-md-4
                                                        p(style="font-weight:bold") Housemaids
                                                    .col-md-8
                                                        |Php 6000 (Negotiable)
                                                .row
                                                    .col-md-4
                                                        p(style="font-weight:bold") Yaya
                                                    .col-md-8
                                                        |Php 6000 (Negotiable)
                                                .row
                                                    .col-md-4
                                                        p(style="font-weight:bold") Cook
                                                    .col-md-8
                                                        |Php 8000 (Negotiable)
                                                .row
                                                    .col-md-4
                                                        p(style="font-weight:bold") Driver
                                                    .col-md-8
                                                        |Php 13k (Stay-in)
                            .modal-footer
                                button.btn.btn-primary.btn-md(type='button'  data-dismiss='modal') Cancel
                                button.btn.btn-success.btn-md(type='submit') Add



        #view_item.modal.fade.modal-icon(tabindex='-1', role='dialog', aria-hidden='true')
            .modal-dialog(role='document')
                .modal-content
                    .modal-header(style="background-color:#2A3F54; color:white")
                        button.close(type='button', data-dismiss='modal')
                            span(aria-hidden='true') ×
                        h4.modal-title#a
                    .modal-body
                        br
                        .row
                            .col-md-1
                                .form-group
                                    |    &nbsp
                            .col-md-3
                                .form-group
                                    | No. of Person Needed
                                    span.required
                                    input.form-control#c(type='number' readonly)
                            br
                            .col-md-3
                                .form-group
                                    | Gender:
                                    span.required
                                    input.form-control#d(type='text' readonly)
                            .form-group &nbsp&nbsp&nbspAge (From - To):
                                .row
                                    .col-md-2
                                        .form-group
                                            input.form-control#age1(type='number' readonly)
                                    .col-md-2
                                        .form-group
                                            input.form-control#age2(type='number' readonly)  
                            
                        .row
                            .col-md-1
                                    .form-group
                                    |    &nbsp
                            br
                            .col-md-3
                                br
                                .form-group
                                    | Highest Educational Attainment:
                                    span.required
                                    input.form-control#e(type='text' readonly)
                            br
                            .col-md-3
                                .form-group
                                    | Work Experience (at least):
                                    span.required
                                    input#f.form-control.col-md-7.col-xs-12(type='number' name='workexp' readonly)
                            .col-md-4
                                .form-group
                                    | Willing to work for a monthly salary of (minimum): PHP
                                    span.required
                                    input.form-control.col-md-7.col-xs-12#sal(type='number' name='salary' readonly)     
                    br
                    .modal-footer
                        button.btn.btn-primary.btn-md(type='button'  data-dismiss='modal') Close
        
        // Deployment Modal
        #deployment.modal.fade.bs-example-modal-lg(tabindex='-1', role='dialog', aria-hidden='true')
            .modal-dialog.modal-sm(style="width:400px;")
                .modal-content
                    form.form-horizontal.form-label-center(method="POST" action='/request_add/contract')
                        .modal-header(style="background-color:#2A3F54; color:white")
                            button.close(type='button', data-dismiss='modal')
                                span(aria-hidden='true') ×
                            h4
                                b Deployment Details
                        .modal-body
                            each list in listtab
                                input(id = 'idtrans' type='text', required='required', name='transid', value=''+list.intRequestID, style="display:none;")  
                                input(id='thedate' type='date', name='reqdate' style='display:none;')
                                input(id='invo' type='text', name='invnum' style='display:none;')
                                br
                                .row
                                    .col-md-12
                                        .form-group
                                            label Type of Deployment
                                            select.form-control(name='dep')
                                                each fee in feetab
                                                    option(value=''+fee.intID) #{fee.strName} &nbsp&nbsp  + P #{fee.fltFee}
                                .row
                                    .col-md-12
                                        .form-group
                                            label Preferred Date For Deployment
                                            .input-group.date
                                                input.form-control.has-feedback-left(type='date', placeholder='First Name', aria-describedby='inputSuccess2Status4'  name='datedep' required)
                                                span.input-group-addon
                                                    span.fa.fa-calendar
                                .row
                                    .col-md-12
                                        .form-group
                                            label Preferred Time For Deployment
                                            .input-group.date
                                                input.form-control.has-feedback-left(type='time' name='timedep' required)
                                                span.input-group-addon
                                                    span.glyphicon.glyphicon-time
                        .modal-footer
                            button.btn.btn-success.btn-md(type='submit',  onCLick='time();') Next
        script.
            function time(){
                var today = new Date();
                var dd = today.getDate();
                var mm = today.getMonth()+1; //January is 0!
                var yyyy = today.getFullYear();
                var hh = today.getHours();
                var min = today.getMinutes();
                var sec = today.getSeconds();
                var x= document.getElementById("thedate");
                var y=document.getElementById("idtrans").value
                var inv;
                
                if(dd<10) {
                    dd = '0'+dd
                } 

                if(mm<10) {
                    mm = '0'+mm
                } 

                today = yyyy + '-' + mm + '-' + dd ;
                //- document.write(today);
               document.getElementById("thedate").value=today;
               inv = yyyy+y;
               document.getElementById("invo").value=inv;
            }